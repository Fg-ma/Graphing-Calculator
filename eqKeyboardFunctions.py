from variables import *
import pyperclip


def eqFunctionTypea():
    cursorPos[0] = cursorPos[0] + cursorPosDict["a"]
    cursorInlinePosition[0] = cursorInlinePosition[0] + 1
    try:
        equations[str(activeFunction[0])][1][cursorInlinePosition[0]] = "a"
    except:
        equations[str(activeFunction[0])][1].append("a")


def eqFunctionTypeb():
    cursorPos[0] = cursorPos[0] + cursorPosDict["b"]
    cursorInlinePosition[0] = cursorInlinePosition[0] + 1
    try:
        equations[str(activeFunction[0])][1][cursorInlinePosition[0]] = "b"
    except:
        equations[str(activeFunction[0])][1].append("b")


def eqFunctionTypec():
    cursorPos[0] = cursorPos[0] + cursorPosDict["c"]
    cursorInlinePosition[0] = cursorInlinePosition[0] + 1
    try:
        equations[str(activeFunction[0])][1][cursorInlinePosition[0]] = "c"
    except:
        equations[str(activeFunction[0])][1].append("c")


def eqFunctionTyped():
    cursorPos[0] = cursorPos[0] + cursorPosDict["d"]
    cursorInlinePosition[0] = cursorInlinePosition[0] + 1
    try:
        equations[str(activeFunction[0])][1][cursorInlinePosition[0]] = "d"
    except:
        equations[str(activeFunction[0])][1].append("d")


def eqFunctionTypee():
    cursorPos[0] = cursorPos[0] + cursorPosDict["e"]
    cursorInlinePosition[0] = cursorInlinePosition[0] + 1
    try:
        equations[str(activeFunction[0])][1][cursorInlinePosition[0]] = "e"
    except:
        equations[str(activeFunction[0])][1].append("e")


def eqFunctionTypef():
    cursorPos[0] = cursorPos[0] + cursorPosDict["f"]
    cursorInlinePosition[0] = cursorInlinePosition[0] + 1
    try:
        equations[str(activeFunction[0])][1][cursorInlinePosition[0]] = "f"
    except:
        equations[str(activeFunction[0])][1].append("f")


def eqFunctionTypeg():
    cursorPos[0] = cursorPos[0] + cursorPosDict["g"]
    cursorInlinePosition[0] = cursorInlinePosition[0] + 1
    try:
        equations[str(activeFunction[0])][1][cursorInlinePosition[0]] = "g"
    except:
        equations[str(activeFunction[0])][1].append("g")


def eqFunctionTypeh():
    cursorPos[0] = cursorPos[0] + cursorPosDict["h"]
    cursorInlinePosition[0] = cursorInlinePosition[0] + 1
    try:
        equations[str(activeFunction[0])][1][cursorInlinePosition[0]] = "h"
    except:
        equations[str(activeFunction[0])][1].append("h")


def eqFunctionTypei():
    cursorPos[0] = cursorPos[0] + cursorPosDict["i"]
    cursorInlinePosition[0] = cursorInlinePosition[0] + 1
    try:
        equations[str(activeFunction[0])][1][cursorInlinePosition[0]] = "i"
    except:
        equations[str(activeFunction[0])][1].append("i")


def eqFunctionTypej():
    cursorPos[0] = cursorPos[0] + cursorPosDict["j"]
    cursorInlinePosition[0] = cursorInlinePosition[0] + 1
    try:
        equations[str(activeFunction[0])][1][cursorInlinePosition[0]] = "j"
    except:
        equations[str(activeFunction[0])][1].append("j")


def eqFunctionTypek():
    cursorPos[0] = cursorPos[0] + cursorPosDict["k"]
    cursorInlinePosition[0] = cursorInlinePosition[0] + 1
    try:
        equations[str(activeFunction[0])][1][cursorInlinePosition[0]] = "k"
    except:
        equations[str(activeFunction[0])][1].append("k")


def eqFunctionTypel():
    cursorPos[0] = cursorPos[0] + cursorPosDict["l"]
    cursorInlinePosition[0] = cursorInlinePosition[0] + 1
    try:
        equations[str(activeFunction[0])][1][cursorInlinePosition[0]] = "l"
    except:
        equations[str(activeFunction[0])][1].append("l")


def eqFunctionTypem():
    cursorPos[0] = cursorPos[0] + cursorPosDict["m"]
    cursorInlinePosition[0] = cursorInlinePosition[0] + 1
    try:
        equations[str(activeFunction[0])][1][cursorInlinePosition[0]] = "m"
    except:
        equations[str(activeFunction[0])][1].append("m")


def eqFunctionTypen():
    cursorPos[0] = cursorPos[0] + cursorPosDict["n"]
    cursorInlinePosition[0] = cursorInlinePosition[0] + 1
    try:
        equations[str(activeFunction[0])][1][cursorInlinePosition[0]] = "n"
    except:
        equations[str(activeFunction[0])][1].append("n")


def eqFunctionTypeo():
    cursorPos[0] = cursorPos[0] + cursorPosDict["o"]
    cursorInlinePosition[0] = cursorInlinePosition[0] + 1
    try:
        equations[str(activeFunction[0])][1][cursorInlinePosition[0]] = "o"
    except:
        equations[str(activeFunction[0])][1].append("o")


def eqFunctionTypep():
    cursorPos[0] = cursorPos[0] + cursorPosDict["p"]
    cursorInlinePosition[0] = cursorInlinePosition[0] + 1
    try:
        equations[str(activeFunction[0])][1][cursorInlinePosition[0]] = "p"
    except:
        equations[str(activeFunction[0])][1].append("p")


def eqFunctionTypeq():
    cursorPos[0] = cursorPos[0] + cursorPosDict["q"]
    cursorInlinePosition[0] = cursorInlinePosition[0] + 1
    try:
        equations[str(activeFunction[0])][1][cursorInlinePosition[0]] = "q"
    except:
        equations[str(activeFunction[0])][1].append("q")


def eqFunctionTyper():
    cursorPos[0] = cursorPos[0] + cursorPosDict["r"]
    cursorInlinePosition[0] = cursorInlinePosition[0] + 1
    try:
        equations[str(activeFunction[0])][1][cursorInlinePosition[0]] = "r"
    except:
        equations[str(activeFunction[0])][1].append("r")


def eqFunctionTypes():
    cursorPos[0] = cursorPos[0] + cursorPosDict["s"]
    cursorInlinePosition[0] = cursorInlinePosition[0] + 1
    try:
        equations[str(activeFunction[0])][1][cursorInlinePosition[0]] = "s"
    except:
        equations[str(activeFunction[0])][1].append("s")


def eqFunctionTypet():
    cursorPos[0] = cursorPos[0] + cursorPosDict["t"]
    cursorInlinePosition[0] = cursorInlinePosition[0] + 1
    try:
        equations[str(activeFunction[0])][1][cursorInlinePosition[0]] = "t"
    except:
        equations[str(activeFunction[0])][1].append("t")


def eqFunctionTypeu():
    cursorPos[0] = cursorPos[0] + cursorPosDict["u"]
    cursorInlinePosition[0] = cursorInlinePosition[0] + 1
    try:
        equations[str(activeFunction[0])][1][cursorInlinePosition[0]] = "u"
    except:
        equations[str(activeFunction[0])][1].append("u")


def eqFunctionTypev():
    cursorPos[0] = cursorPos[0] + cursorPosDict["v"]
    cursorInlinePosition[0] = cursorInlinePosition[0] + 1
    try:
        equations[str(activeFunction[0])][1][cursorInlinePosition[0]] = "v"
    except:
        equations[str(activeFunction[0])][1].append("v")


def eqFunctionTypew():
    cursorPos[0] = cursorPos[0] + cursorPosDict["w"]
    cursorInlinePosition[0] = cursorInlinePosition[0] + 1
    try:
        equations[str(activeFunction[0])][1][cursorInlinePosition[0]] = "w"
    except:
        equations[str(activeFunction[0])][1].append("w")


def eqFunctionTypex():
    cursorPos[0] = cursorPos[0] + cursorPosDict["x"]
    cursorInlinePosition[0] = cursorInlinePosition[0] + 1
    try:
        equations[str(activeFunction[0])][1][cursorInlinePosition[0]] = "x"
    except:
        equations[str(activeFunction[0])][1].append("x")


def eqFunctionTypey():
    cursorPos[0] = cursorPos[0] + cursorPosDict["y"]
    cursorInlinePosition[0] = cursorInlinePosition[0] + 1
    try:
        equations[str(activeFunction[0])][1][cursorInlinePosition[0]] = "y"
    except:
        equations[str(activeFunction[0])][1].append("y")


def eqFunctionTypez():
    cursorPos[0] = cursorPos[0] + cursorPosDict["z"]
    cursorInlinePosition[0] = cursorInlinePosition[0] + 1
    try:
        equations[str(activeFunction[0])][1][cursorInlinePosition[0]] = "z"
    except:
        equations[str(activeFunction[0])][1].append("z")


def eqFunctionTypeExclamation():
    cursorPos[0] = cursorPos[0] + cursorPosDict["!"]
    cursorInlinePosition[0] = cursorInlinePosition[0] + 1
    try:
        equations[str(activeFunction[0])][1][cursorInlinePosition[0]] = "!"
    except:
        equations[str(activeFunction[0])][1].append("!")


def eqFunctionTypeAt():
    cursorPos[0] = cursorPos[0] + cursorPosDict["@"]
    cursorInlinePosition[0] = cursorInlinePosition[0] + 1
    try:
        equations[str(activeFunction[0])][1][cursorInlinePosition[0]] = "@"
    except:
        equations[str(activeFunction[0])][1].append("@")


def eqFunctionTypeNumberSign():
    cursorPos[0] = cursorPos[0] + cursorPosDict["#"]
    cursorInlinePosition[0] = cursorInlinePosition[0] + 1
    try:
        equations[str(activeFunction[0])][1][cursorInlinePosition[0]] = "#"
    except:
        equations[str(activeFunction[0])][1].append("#")


def eqFunctionTypeDollarSign():
    cursorPos[0] = cursorPos[0] + cursorPosDict["$"]
    cursorInlinePosition[0] = cursorInlinePosition[0] + 1
    try:
        equations[str(activeFunction[0])][1][cursorInlinePosition[0]] = "$"
    except:
        equations[str(activeFunction[0])][1].append("$")


def eqFunctionTypePercent():
    cursorPos[0] = cursorPos[0] + cursorPosDict["%"]
    cursorInlinePosition[0] = cursorInlinePosition[0] + 1
    try:
        equations[str(activeFunction[0])][1][cursorInlinePosition[0]] = "%"
    except:
        equations[str(activeFunction[0])][1].append("%")


def eqFunctionTypeAmpersand():
    cursorPos[0] = cursorPos[0] + cursorPosDict["&"]
    cursorInlinePosition[0] = cursorInlinePosition[0] + 1
    try:
        equations[str(activeFunction[0])][1][cursorInlinePosition[0]] = "&"
    except:
        equations[str(activeFunction[0])][1].append("&")


def eqFunctionTypeBackspace():

    """
    If the cursor is in the last position of the line then the last value is removed and the cursor moves accordingly,
    if the cursor is in any position but the last then whatever value that is above the cursor is removed.
    """

    if cursorInlinePosition[0] == len(equations[str(activeFunction[0])][1]) - 1 and not cursorInlinePosition[0] == -1:
        removed = equations[str(activeFunction[0])][1].pop(cursorInlinePosition[0])
        if equationsPosHorizontalShift[str(activeFunction[0])] >= 0:
            cursorPos[0] = cursorPos[0] - cursorPosDict[removed]
        cursorInlinePosition[0] = cursorInlinePosition[0] - 1
        if not equationsPosHorizontalShift[str(activeFunction[0])] >= 0:
            equationsPosHorizontalShift[str(activeFunction[0])] = equationsPosHorizontalShift[str(activeFunction[0])] + cursorPosDict[removed]
    if cursorInlinePosition[0] < len(equations[str(activeFunction[0])][1]) - 1:
        equations[str(activeFunction[0])][1].pop(cursorInlinePosition[0] + 1)


def eqFunctionTypeDelete():
    
    """
    Unlike backspace function, it only removes the value above the cursor,
    so if the cursor is in the last position in the line nothing happens.
    """

    if cursorInlinePosition[0] < len(equations[str(activeFunction[0])][1]) - 1:
        equations[str(activeFunction[0])][1].pop(cursorInlinePosition[0] + 1)
        

def eqFunctionTypeControlC():

    """
    Copies whatever value is in the current equation to the clipboard.
    """

    copy = "".join(equations[str(activeFunction[0])][1])
    pyperclip.copy(copy)


def eqFunctionTypeControlV():

    """
    Pastes whatever value is in the clipboard to the current equation.
    """

    paste = pyperclip.paste()
    for i in [*paste]:
        cursorPos[0] = cursorPos[0] + cursorPosDict[i]
        cursorInlinePosition[0] = cursorInlinePosition[0] + 1
        equations[str(activeFunction[0])][1].append(i)
    

def eqFunctionTypeControlZ():

    """
    Removes the last value in the current equation line.
    """

    if cursorInlinePosition[0] != -1:
        removed = equations[str(activeFunction[0])][1].pop(cursorInlinePosition[0])
        if equationsPosHorizontalShift[str(activeFunction[0])] >= 0:
            cursorPos[0] = cursorPos[0] - cursorPosDict[removed]
        cursorInlinePosition[0] = cursorInlinePosition[0] - 1
        if not equationsPosHorizontalShift[str(activeFunction[0])] >= 0:
            equationsPosHorizontalShift[str(activeFunction[0])] = equationsPosHorizontalShift[str(activeFunction[0])] + cursorPosDict[removed]